/*!
 * (C) Ionic http://ionicframework.com - MIT License
 * Built with http://stenciljs.com
 */
const{h:t}=window.Ionic;import{pointerCoord as e}from"./chunk3.js";const n="$ionRelocated";function o(t,e,o,i=0){if(t[n]!==o){if(e.value,o){!function(t,e){const n=t.parentElement;if(t&&n){const o=t.offsetTop,i=t.offsetLeft,s=t.offsetWidth,r=t.offsetHeight,a=document.createElement("div"),c=a.style;a.classList.add(...Array.from(t.classList)),a.classList.add("cloned-input"),a.setAttribute("aria-hidden","true"),c.pointerEvents="none",c.position="absolute",c.top=o+"px",c.left=i+"px",c.width=s+"px",c.height=r+"px";const l=document.createElement("input");l.classList.add(...Array.from(e.classList)),l.value=e.value,l.type=e.type,l.placeholder=e.placeholder,l.tabIndex=-1,a.appendChild(l),n.appendChild(a),t.style.pointerEvents="none"}e.style.transform="scale(0)"}(t,e);const n="rtl"===document.dir?9999:-9999;e.style.transform=`translate3d(${n}px,${i}px,0)`}else!function(t,e){if(t&&t.parentElement){const e=t.parentElement.querySelectorAll(".cloned-input");for(let t=0;t<e.length;t++)e[t].remove();t.style.pointerEvents=""}e.style.transform="",e.style.opacity=""}(t,e);t[n]=o}}function i(t){return t===document.activeElement}const s=["INPUT","TEXTAREA","ION-INPUT","ION-TEXTAREA"],r=.3;function a(t,n,s,a){let c;const l=t=>{c=e(t),t.type},d=l=>{if(l.type,!c)return;const d=e(l);(function(t,e,n){if(e&&n){const t=e.x-n.x,o=e.y-n.y;return t*t+o*o>36}return!1})(0,c,d)||i(n)||(l.preventDefault(),l.stopPropagation(),function(t,e,n,i){const s=function(t,e,n){return e?function(t,e,n,o){const i=t.top,s=t.bottom,a=e.top+10,c=Math.min(e.bottom,o-n)/2-s,l=a-i,d=Math.round(c<0?-c:l>0?-l:0),u=Math.abs(d)/r;return{scrollAmount:d,scrollDuration:Math.min(400,Math.max(150,u)),scrollPadding:n,inputSafeY:4-(i-a)}}((t.closest("ion-item,[ion-item]")||t).getBoundingClientRect(),e.getBoundingClientRect(),n,window.innerHeight):{scrollAmount:0,scrollPadding:0,scrollDuration:0,inputSafeY:0}}(t,n,i);Math.abs(s.scrollAmount)<4?e.focus():(o(t,e,!0,s.inputSafeY),e.focus(),n.scrollByPoint(0,s.scrollAmount,s.scrollDuration,()=>{o(t,e,!1,s.inputSafeY),e.focus()}))}(t,n,s,a))};return t.addEventListener("touchstart",l,!0),t.addEventListener("touchend",d,!0),()=>{t.removeEventListener("touchstart",l,!0),t.removeEventListener("touchend",d,!0)}}const c="$ionPaddingTimer";function l(t,e){if("INPUT"!==t.tagName)return;if(t.parentElement&&"ION-INPUT"===t.parentElement.tagName)return;const n=t.closest(".scroll-inner");if(!n)return;const o=n[c];o&&clearTimeout(o),e>0?n.style.paddingBottom=e+"px":n[c]=setTimeout(()=>{n.style.paddingBottom=""},120)}const d=!0,u=!0,h=!0,p=!0;class f{constructor(){this.didLoad=!1,this.hideCaret=!1,this.scrollAssist=!1,this.keyboardHeight=0,this.hideCaretMap=new WeakMap,this.scrollAssistMap=new WeakMap}componentDidLoad(){this.keyboardHeight=this.config.getNumber("keyboardHeight",290),this.scrollAssist=this.config.getBoolean("scrollAssist",!0),this.hideCaret=this.config.getBoolean("hideCaretOnScroll",!0),this.config.getBoolean("inputBlurring",!0)&&d&&function(){let t=!0,e=!1;document.addEventListener("ionScrollStart",function(){e=!0}),document.addEventListener("focusin",function(){t=!0},!0),document.addEventListener("touchend",function(n){if(e)return void(e=!1);const o=document.activeElement;if(!o)return;if(-1===s.indexOf(o.tagName))return;const i=n.target;i!==o&&(s.indexOf(i.tagName)>=0||i.classList.contains("input-cover")||(t=!1,setTimeout(()=>{t||o.blur()},50)))},!1)}(),this.config.getBoolean("scrollPadding",!0)&&h&&function(t){document.addEventListener("focusin",function(e){l(e.target,t)}),document.addEventListener("focusout",function(t){l(t.target,0)})}(this.keyboardHeight);const t=Array.from(document.querySelectorAll("ion-input"));for(const e of t)this.registerInput(e);this.didLoad=!0}onInputDidLoad(t){this.didLoad&&this.registerInput(t.detail)}onInputDidUnload(t){this.didLoad&&this.unregisterInput(t.detail)}registerInput(t){const e=t.querySelector("input"),n=t.closest("ion-scroll"),s=t.closest("ion-content");if(e){if(p&&n&&this.hideCaret&&!this.hideCaretMap.has(t)){const s=function(t,e,n){if(!n||!e)return()=>{};const s=n=>{i(e)&&o(t,e,n)},r=()=>o(t,e,!1),a=()=>s(!0),c=()=>s(!1);return n&&n.addEventListener("ionScrollStart",a),n&&n.addEventListener("ionScrollEnd",c),e.addEventListener("blur",r),()=>{n.removeEventListener("ionScrollStart",a),n.removeEventListener("ionScrollEnd",c),e.addEventListener("ionBlur",r)}}(t,e,n);this.hideCaretMap.set(t,s)}if(u&&s&&this.scrollAssist&&!this.scrollAssistMap.has(t)){const n=a(t,e,s,this.keyboardHeight);this.scrollAssistMap.set(t,n)}}}unregisterInput(t){if(p&&this.hideCaret){const e=this.hideCaretMap.get(t);e&&e(),this.hideCaretMap.delete(t)}if(u&&this.scrollAssist){const e=this.scrollAssistMap.get(t);e&&e(),this.scrollAssistMap.delete(t)}}static get is(){return"ion-input-shims"}static get properties(){return{config:{context:"config"}}}static get listeners(){return[{name:"body:ionInputDidLoad",method:"onInputDidLoad"},{name:"body:ionInputDidUnload",method:"onInputDidUnload"}]}}export{f as IonInputShims};